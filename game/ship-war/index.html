<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <title>军舰大战 - ChiwaInori.top</title>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="stylesheet" href="/css/global.css" />
    <link rel="stylesheet" href="/css/type-center.css" />
    <style>
        :root {
            --minor: #ff0077;
        }

        div#rules *, div#choose_first *, div#main_panel * {
            text-align: center; 
            margin-left: 0px;
        }

        #goodTitle, #choose_first > h2 {
            margin-top: 32px;
        }

        #subtitle {
            margin-bottom: 32px;
        }

        .left_table { 
            margin: auto auto auto 9.5% !important;
        }

        #p1_status {
            margin: auto auto auto -45% !important;
        }

        #p2_status {
            margin: -93px auto auto 50% !important;
        }

        table button {
            margin-right: 0px;
        }

        @media screen and (min-width: 700px) {
            .left_table { 
                margin: auto auto auto 29.5% !important;
            }

            #p1_status {
                margin: auto auto auto -30.5% !important;
            }

            #p2_status {
                margin: -93px auto auto 34% !important;
            }
        }
    </style>
    <script src="/chiwa-functions.js"></script>
</head>

<body><div id="cw-main">
    <div id="cw-title">
        <h1 style="text-align: center; margin-left: 0px;">军舰大战</h1>
    </div>
    <div id="cw-nav"><h6>&nbsp;</h6></div>
    <div id="cw-content">
        <div id="rules">
            <p>欢迎体验 ChiwaInori.top 的 军舰大战 小游戏!</p>
            <br />
            <h2>游戏规则</h2>
            <p>在游戏开始时, 两个玩家都会有一个 6*6 的显示盘 (Display Panel, &quot;(D)&quot;), 并且需要<strong>在屏幕中间放置隔板</strong>等方式, 让双方互相看不到对方的棋盘. 你的棋盘下面还会有一个 6x6 的控制板 (Operation Panel, &quot;(O)&quot;).</p>
            <p>双方需要选择一个方格作为自己的<strong>母舰</strong>的位置, 通过按下控制盘上对应的按钮来进行.</p>
            <br />
            <p>随后, 先手选择一个空格放置自己新的战列舰, 然后选择一个敌方的位置来进行打击. 然后, 后手进行同样的操作, 以此循环.</p>
            <p>如果自己的母舰被摧毁, 那么就无法放置更多的战列舰了. 此时被摧毁母舰的玩家在击中地方军舰后可以<strong>继续攻击, 直至打空</strong>.</p>
            <p>把对方的所有军舰全部击毁, 你就赢了.</p>
            <br />
            <p style="margin-left: 20%;"><button onclick="begin()">点击开始</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(或 <input type="file" id="saveInput" accept=".json" />)</p>
            <p id="text1" style="font-size: 10px;">若选择读取游戏, 请在选择存档文件后点击 &quot;点击开始&quot; 按钮.</p>
            <!-- <p class="STX">如果你的存档文件是 .top 格式, 请在本网页的地址后面加上 /../archive_100_a.html 以尝试在支持 .top 的版本中加载.</p> -->
            <br /><br />
            <h6 style="color: var(--gray)">ChiwaInori.top ShipWar v<span id="version"></span>. 本游戏的灵感与本网站所有代码均为 <ruby>千和<rt>ちわ</rt></ruby> いのり 所作。<span id="copyright" style="color: var(--gray)"></span></h6>
        </div>
        <div id="choose_first" style="display: none;">
            <h2>选择游戏模式</h2>
            <br /><br />
            <h3>本地对战</h3>
            <p style="position: relative; left: 0%;"><button onclick="firstPlayer(1)">左侧先手</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="randomFirst()">随机先手</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="firstPlayer(2)">右侧先手</button></p>
            <br />
            <h3>单人游戏</h3>
            <p style="position: relative; left: 0%;"><button onclick="startRobot(1)">玩家先手</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="startRobot(0)">随机先手</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="startRobot(2)">人机先手</button></p>
            <br />
            <h3>联机模式</h3>
            <!-- <p id="online_button" style="position: relative; left: 0%;"><button onclick="showOnlineText()">联机模式</button></p> -->
            <p>如需游玩此联机模式, 请循环遵循以下步骤.</p>
            <p>1. 你在你的电脑上进行操作, 包括放置战列舰、选择攻击位置</p>
            <p>2. 此网页将会根据你的操作生成一段代码, 你需要把这串代码发送给你的好友</p>
            <p>3. 你的好友在他的电脑上输入代码, 通过读取代码来知道你的操作</p>
            <p>4. 你的好友完成他的操作后, 将代码发送给你, 你输入代码后继续你的操作</p>
            <p><button onclick="onlineFirst(1)">我方先手</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="onlineRandomFirst()">随机先手</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="onlineFirst(2)">好友先手</button></p>
            <p>好友已准备好? 请输入代码: <input id="code_type" style="width: 50px;" /><button onclick="onlineCodeEnter()" style="margin-left: 16px;">确认</button></p>
            <p id="wrong_code" style="color: var(--red); font-size: 10px;"></p>
        </div>
        <div id="main_panel" style="display: none;">
            <h2 id="goodTitle">放置母舰</h2>
            <h6 id="subtitle">请准备好物理阻拦物, 确保玩家不会看到对方的操作界面</h6>
            <h6 style="color: #00a8ff; display: none;" id="subtitle_showOne">单显示模式已开启 - 同一时刻仅会显示一个玩家的操作界面</h6>
            <table id="p1_table_1" class="BRT left_table">
                <tr><th>(D)</th><th>&nbsp;A&nbsp;</th><th>&nbsp;B&nbsp;</th><th>&nbsp;C&nbsp;</th><th>&nbsp;D&nbsp;</th><th>&nbsp;E&nbsp;</th><th>&nbsp;F&nbsp;</th></tr>
                <tr><th>1</th><th id="display_p1_1">&nbsp;</th><th id="display_p1_2">&nbsp;</th><th id="display_p1_3">&nbsp;</th><th id="display_p1_4">&nbsp;</th><th id="display_p1_5">&nbsp;</th><th id="display_p1_6">&nbsp;</th></tr>
                <tr><th>2</th><th id="display_p1_7">&nbsp;</th><th id="display_p1_8">&nbsp;</th><th id="display_p1_9">&nbsp;</th><th id="display_p1_10">&nbsp;</th><th id="display_p1_11">&nbsp;</th><th id="display_p1_12">&nbsp;</th></tr>
                <tr><th>3</th><th id="display_p1_13">&nbsp;</th><th id="display_p1_14">&nbsp;</th><th id="display_p1_15">&nbsp;</th><th id="display_p1_16">&nbsp;</th><th id="display_p1_17">&nbsp;</th><th id="display_p1_18">&nbsp;</th></tr>
                <tr><th>4</th><th id="display_p1_19">&nbsp;</th><th id="display_p1_20">&nbsp;</th><th id="display_p1_21">&nbsp;</th><th id="display_p1_22">&nbsp;</th><th id="display_p1_23">&nbsp;</th><th id="display_p1_24">&nbsp;</th></tr>
                <tr><th>5</th><th id="display_p1_25">&nbsp;</th><th id="display_p1_26">&nbsp;</th><th id="display_p1_27">&nbsp;</th><th id="display_p1_28">&nbsp;</th><th id="display_p1_29">&nbsp;</th><th id="display_p1_30">&nbsp;</th></tr>
                <tr><th>6</th><th id="display_p1_31">&nbsp;</th><th id="display_p1_32">&nbsp;</th><th id="display_p1_33">&nbsp;</th><th id="display_p1_34">&nbsp;</th><th id="display_p1_35">&nbsp;</th><th id="display_p1_36">&nbsp;</th></tr>
            </table>
            <table id="p2_table_1" class="BRT p2_table" style="margin: -177px auto auto 61.5%">
                <tr><th>(D)</th><th>&nbsp;A&nbsp;</th><th>&nbsp;B&nbsp;</th><th>&nbsp;C&nbsp;</th><th>&nbsp;D&nbsp;</th><th>&nbsp;E&nbsp;</th><th>&nbsp;F&nbsp;</th></tr>
                <tr><th>1</th><th id="display_p2_1">&nbsp;</th><th id="display_p2_2">&nbsp;</th><th id="display_p2_3">&nbsp;</th><th id="display_p2_4">&nbsp;</th><th id="display_p2_5">&nbsp;</th><th id="display_p2_6">&nbsp;</th></tr>
                <tr><th>2</th><th id="display_p2_7">&nbsp;</th><th id="display_p2_8">&nbsp;</th><th id="display_p2_9">&nbsp;</th><th id="display_p2_10">&nbsp;</th><th id="display_p2_11">&nbsp;</th><th id="display_p2_12">&nbsp;</th></tr>
                <tr><th>3</th><th id="display_p2_13">&nbsp;</th><th id="display_p2_14">&nbsp;</th><th id="display_p2_15">&nbsp;</th><th id="display_p2_16">&nbsp;</th><th id="display_p2_17">&nbsp;</th><th id="display_p2_18">&nbsp;</th></tr>
                <tr><th>4</th><th id="display_p2_19">&nbsp;</th><th id="display_p2_20">&nbsp;</th><th id="display_p2_21">&nbsp;</th><th id="display_p2_22">&nbsp;</th><th id="display_p2_23">&nbsp;</th><th id="display_p2_24">&nbsp;</th></tr>
                <tr><th>5</th><th id="display_p2_25">&nbsp;</th><th id="display_p2_26">&nbsp;</th><th id="display_p2_27">&nbsp;</th><th id="display_p2_28">&nbsp;</th><th id="display_p2_29">&nbsp;</th><th id="display_p2_30">&nbsp;</th></tr>
                <tr><th>6</th><th id="display_p2_31">&nbsp;</th><th id="display_p2_32">&nbsp;</th><th id="display_p2_33">&nbsp;</th><th id="display_p2_34">&nbsp;</th><th id="display_p2_35">&nbsp;</th><th id="display_p2_36">&nbsp;</th></tr>
            </table>
            <br />
            <table id="p1_table_2" class="BRT left_table">
                <tr><th>(O)</th><th>&nbsp;A&nbsp;</th><th>&nbsp;B&nbsp;</th><th>&nbsp;C&nbsp;</th><th>&nbsp;D&nbsp;</th><th>&nbsp;E&nbsp;</th><th>&nbsp;F&nbsp;</th>
                </tr>
                <tr>
                    <th>1</th>
                    <th><button id="p1PlaceBigButton1" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(1)">&nbsp;</button><button id="p1PlaceSmallButton1" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(1)">&nbsp;</button><button id="p1AttackButton1" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(1)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton2" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(2)">&nbsp;</button><button id="p1PlaceSmallButton2" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(2)">&nbsp;</button><button id="p1AttackButton2" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(2)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton3" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(3)">&nbsp;</button><button id="p1PlaceSmallButton3" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(3)">&nbsp;</button><button id="p1AttackButton3" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(3)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton4" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(4)">&nbsp;</button><button id="p1PlaceSmallButton4" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(4)">&nbsp;</button><button id="p1AttackButton4" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(4)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton5" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(5)">&nbsp;</button><button id="p1PlaceSmallButton5" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(5)">&nbsp;</button><button id="p1AttackButton5" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(5)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton6" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(6)">&nbsp;</button><button id="p1PlaceSmallButton6" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(6)">&nbsp;</button><button id="p1AttackButton6" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(6)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>2</th>
                    <th><button id="p1PlaceBigButton7" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(7)">&nbsp;</button><button id="p1PlaceSmallButton7" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(7)">&nbsp;</button><button id="p1AttackButton7" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(7)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton8" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(8)">&nbsp;</button><button id="p1PlaceSmallButton8" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(8)">&nbsp;</button><button id="p1AttackButton8" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(8)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton9" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(9)">&nbsp;</button><button id="p1PlaceSmallButton9" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(9)">&nbsp;</button><button id="p1AttackButton9" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(9)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton10" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(10)">&nbsp;</button><button id="p1PlaceSmallButton10" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(10)">&nbsp;</button><button id="p1AttackButton10" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(10)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton11" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(11)">&nbsp;</button><button id="p1PlaceSmallButton11" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(11)">&nbsp;</button><button id="p1AttackButton11" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(11)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton12" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(12)">&nbsp;</button><button id="p1PlaceSmallButton12" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(12)">&nbsp;</button><button id="p1AttackButton12" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(12)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>3</th>
                    <th><button id="p1PlaceBigButton13" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(13)">&nbsp;</button><button id="p1PlaceSmallButton13" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(13)">&nbsp;</button><button id="p1AttackButton13" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(13)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton14" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(14)">&nbsp;</button><button id="p1PlaceSmallButton14" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(14)">&nbsp;</button><button id="p1AttackButton14" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(14)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton15" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(15)">&nbsp;</button><button id="p1PlaceSmallButton15" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(15)">&nbsp;</button><button id="p1AttackButton15" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(15)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton16" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(16)">&nbsp;</button><button id="p1PlaceSmallButton16" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(16)">&nbsp;</button><button id="p1AttackButton16" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(16)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton17" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(17)">&nbsp;</button><button id="p1PlaceSmallButton17" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(17)">&nbsp;</button><button id="p1AttackButton17" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(17)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton18" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(18)">&nbsp;</button><button id="p1PlaceSmallButton18" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(18)">&nbsp;</button><button id="p1AttackButton18" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(18)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>4</th>
                    <th><button id="p1PlaceBigButton19" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(19)">&nbsp;</button><button id="p1PlaceSmallButton19" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(19)">&nbsp;</button><button id="p1AttackButton19" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(19)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton20" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(20)">&nbsp;</button><button id="p1PlaceSmallButton20" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(20)">&nbsp;</button><button id="p1AttackButton20" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(20)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton21" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(21)">&nbsp;</button><button id="p1PlaceSmallButton21" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(21)">&nbsp;</button><button id="p1AttackButton21" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(21)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton22" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(22)">&nbsp;</button><button id="p1PlaceSmallButton22" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(22)">&nbsp;</button><button id="p1AttackButton22" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(22)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton23" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(23)">&nbsp;</button><button id="p1PlaceSmallButton23" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(23)">&nbsp;</button><button id="p1AttackButton23" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(23)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton24" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(24)">&nbsp;</button><button id="p1PlaceSmallButton24" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(24)">&nbsp;</button><button id="p1AttackButton24" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(24)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>5</th>
                    <th><button id="p1PlaceBigButton25" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(25)">&nbsp;</button><button id="p1PlaceSmallButton25" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(25)">&nbsp;</button><button id="p1AttackButton25" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(25)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton26" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(26)">&nbsp;</button><button id="p1PlaceSmallButton26" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(26)">&nbsp;</button><button id="p1AttackButton26" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(26)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton27" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(27)">&nbsp;</button><button id="p1PlaceSmallButton27" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(27)">&nbsp;</button><button id="p1AttackButton27" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(27)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton28" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(28)">&nbsp;</button><button id="p1PlaceSmallButton28" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(28)">&nbsp;</button><button id="p1AttackButton28" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(28)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton29" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(29)">&nbsp;</button><button id="p1PlaceSmallButton29" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(29)">&nbsp;</button><button id="p1AttackButton29" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(29)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton30" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(30)">&nbsp;</button><button id="p1PlaceSmallButton30" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(30)">&nbsp;</button><button id="p1AttackButton30" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(30)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>6</th>
                    <th><button id="p1PlaceBigButton31" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(31)">&nbsp;</button><button id="p1PlaceSmallButton31" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(31)">&nbsp;</button><button id="p1AttackButton31" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(31)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton32" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(32)">&nbsp;</button><button id="p1PlaceSmallButton32" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(32)">&nbsp;</button><button id="p1AttackButton32" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(32)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton33" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(33)">&nbsp;</button><button id="p1PlaceSmallButton33" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(33)">&nbsp;</button><button id="p1AttackButton33" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(33)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton34" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(34)">&nbsp;</button><button id="p1PlaceSmallButton34" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(34)">&nbsp;</button><button id="p1AttackButton34" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(34)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton35" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(35)">&nbsp;</button><button id="p1PlaceSmallButton35" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(35)">&nbsp;</button><button id="p1AttackButton35" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(35)">&nbsp;</button></th>
                    <th><button id="p1PlaceBigButton36" style="margin-bottom: -3px; margin-left: -1px;" onclick="p1PlaceBig(36)">&nbsp;</button><button id="p1PlaceSmallButton36" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1PlaceSmall(36)">&nbsp;</button><button id="p1AttackButton36" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p1Attack(36)">&nbsp;</button></th>
                </tr>
            </table>
            <table id="p2_table_2" class="BRT" style="margin: -195px auto auto 61.5%;">
                <tr><th>(O)</th><th>&nbsp;A&nbsp;</th><th>&nbsp;B&nbsp;</th><th>&nbsp;C&nbsp;</th><th>&nbsp;D&nbsp;</th><th>&nbsp;E&nbsp;</th><th>&nbsp;F&nbsp;</th>
                </tr>
                <tr>
                    <th>1</th>
                    <th><button id="p2PlaceBigButton1" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(1)">&nbsp;</button><button id="p2PlaceSmallButton1" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(1)">&nbsp;</button><button id="p2AttackButton1" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(1)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton2" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(2)">&nbsp;</button><button id="p2PlaceSmallButton2" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(2)">&nbsp;</button><button id="p2AttackButton2" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(2)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton3" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(3)">&nbsp;</button><button id="p2PlaceSmallButton3" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(3)">&nbsp;</button><button id="p2AttackButton3" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(3)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton4" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(4)">&nbsp;</button><button id="p2PlaceSmallButton4" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(4)">&nbsp;</button><button id="p2AttackButton4" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(4)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton5" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(5)">&nbsp;</button><button id="p2PlaceSmallButton5" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(5)">&nbsp;</button><button id="p2AttackButton5" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(5)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton6" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(6)">&nbsp;</button><button id="p2PlaceSmallButton6" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(6)">&nbsp;</button><button id="p2AttackButton6" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(6)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>2</th>
                    <th><button id="p2PlaceBigButton7" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(7)">&nbsp;</button><button id="p2PlaceSmallButton7" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(7)">&nbsp;</button><button id="p2AttackButton7" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(7)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton8" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(8)">&nbsp;</button><button id="p2PlaceSmallButton8" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(8)">&nbsp;</button><button id="p2AttackButton8" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(8)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton9" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(9)">&nbsp;</button><button id="p2PlaceSmallButton9" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(9)">&nbsp;</button><button id="p2AttackButton9" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(9)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton10" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(10)">&nbsp;</button><button id="p2PlaceSmallButton10" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(10)">&nbsp;</button><button id="p2AttackButton10" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(10)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton11" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(11)">&nbsp;</button><button id="p2PlaceSmallButton11" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(11)">&nbsp;</button><button id="p2AttackButton11" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(11)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton12" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(12)">&nbsp;</button><button id="p2PlaceSmallButton12" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(12)">&nbsp;</button><button id="p2AttackButton12" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(12)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>3</th>
                    <th><button id="p2PlaceBigButton13" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(13)">&nbsp;</button><button id="p2PlaceSmallButton13" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(13)">&nbsp;</button><button id="p2AttackButton13" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(13)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton14" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(14)">&nbsp;</button><button id="p2PlaceSmallButton14" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(14)">&nbsp;</button><button id="p2AttackButton14" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(14)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton15" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(15)">&nbsp;</button><button id="p2PlaceSmallButton15" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(15)">&nbsp;</button><button id="p2AttackButton15" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(15)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton16" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(16)">&nbsp;</button><button id="p2PlaceSmallButton16" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(16)">&nbsp;</button><button id="p2AttackButton16" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(16)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton17" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(17)">&nbsp;</button><button id="p2PlaceSmallButton17" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(17)">&nbsp;</button><button id="p2AttackButton17" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(17)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton18" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(18)">&nbsp;</button><button id="p2PlaceSmallButton18" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(18)">&nbsp;</button><button id="p2AttackButton18" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(18)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>4</th>
                    <th><button id="p2PlaceBigButton19" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(19)">&nbsp;</button><button id="p2PlaceSmallButton19" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(19)">&nbsp;</button><button id="p2AttackButton19" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(19)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton20" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(20)">&nbsp;</button><button id="p2PlaceSmallButton20" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(20)">&nbsp;</button><button id="p2AttackButton20" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(20)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton21" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(21)">&nbsp;</button><button id="p2PlaceSmallButton21" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(21)">&nbsp;</button><button id="p2AttackButton21" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(21)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton22" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(22)">&nbsp;</button><button id="p2PlaceSmallButton22" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(22)">&nbsp;</button><button id="p2AttackButton22" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(22)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton23" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(23)">&nbsp;</button><button id="p2PlaceSmallButton23" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(23)">&nbsp;</button><button id="p2AttackButton23" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(23)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton24" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(24)">&nbsp;</button><button id="p2PlaceSmallButton24" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(24)">&nbsp;</button><button id="p2AttackButton24" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(24)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>5</th>
                    <th><button id="p2PlaceBigButton25" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(25)">&nbsp;</button><button id="p2PlaceSmallButton25" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(25)">&nbsp;</button><button id="p2AttackButton25" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(25)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton26" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(26)">&nbsp;</button><button id="p2PlaceSmallButton26" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(26)">&nbsp;</button><button id="p2AttackButton26" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(26)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton27" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(27)">&nbsp;</button><button id="p2PlaceSmallButton27" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(27)">&nbsp;</button><button id="p2AttackButton27" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(27)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton28" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(28)">&nbsp;</button><button id="p2PlaceSmallButton28" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(28)">&nbsp;</button><button id="p2AttackButton28" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(28)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton29" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(29)">&nbsp;</button><button id="p2PlaceSmallButton29" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(29)">&nbsp;</button><button id="p2AttackButton29" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(29)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton30" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(30)">&nbsp;</button><button id="p2PlaceSmallButton30" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(30)">&nbsp;</button><button id="p2AttackButton30" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(30)">&nbsp;</button></th>
                </tr>
                <tr>
                    <th>6</th>
                    <th><button id="p2PlaceBigButton31" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(31)">&nbsp;</button><button id="p2PlaceSmallButton31" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(31)">&nbsp;</button><button id="p2AttackButton31" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(31)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton32" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(32)">&nbsp;</button><button id="p2PlaceSmallButton32" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(32)">&nbsp;</button><button id="p2AttackButton32" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(32)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton33" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(33)">&nbsp;</button><button id="p2PlaceSmallButton33" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(33)">&nbsp;</button><button id="p2AttackButton33" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(33)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton34" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(34)">&nbsp;</button><button id="p2PlaceSmallButton34" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(34)">&nbsp;</button><button id="p2AttackButton34" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(34)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton35" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(35)">&nbsp;</button><button id="p2PlaceSmallButton35" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(35)">&nbsp;</button><button id="p2AttackButton35" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(35)">&nbsp;</button></th>
                    <th><button id="p2PlaceBigButton36" style="margin-bottom: -3px; margin-left: -1px;" onclick="p2PlaceBig(36)">&nbsp;</button><button id="p2PlaceSmallButton36" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2PlaceSmall(36)">&nbsp;</button><button id="p2AttackButton36" style="margin-bottom: -3px; margin-left: -1px; display: none;" onclick="p2Attack(36)">&nbsp;</button></th>
                </tr>
            </table>
            <br />
            <!--
            <p style="position: relative; left: 0%;"><span id="p1_status_1"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="p2_status_1"></span></p>
            <p style="position: relative; left: 0%;"><span id="p1_status_2"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="p2_status_2"></span></p>
            -->
            <div id="p1_status" style="margin: auto auto auto -32%;">
                <p id="p1_status_1">&nbsp;</p>
                <p id="p1_status_2">&nbsp;</p>
                <p id="p1_status_3">&nbsp;</p>
                <!-- <p id="p1_save"><button onclick="p1_save()">保存</button></p>
                <h6 id="p1_save_id" style="font-size: 1px;">&nbsp;</h6> -->
            </div>
            <div id="p2_status" style="margin: -93px auto auto 32%;">
                <p id="p2_status_1">&nbsp;</p>
                <p id="p2_status_2">&nbsp;</p>
                <p id="p2_status_3">&nbsp;</p>
            </div>
            <button id="saveButton" style="display: none;" onclick="saveGame()">保存游戏</button>
            <br /><div id="brs"><br /><br /><br /><br /></div>
            <div id="online_finish" style="display: none;">
                <div id="online-area">
                    <h4>你的操作已经结束. 请将以下代码发送给你的好友:</h4>
                    <h5 id="online_code"></h5>
                    <p id="online_input">将好友发给你的代码输入: <input id="code_from_friend" style="width: 100px;" /><button id="online_b1" onclick="onlineContinue()" style="margin-left: 16px;" disabled>确认</button><span id="confirm" style="display: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="onlineContinueForce()" style="margin-left: 16px;">确认</button></span></p>
                    <h5 id="online_warn" style="font-size: 10px;"></h5>
                    </div>
                <p id="single-await" hidden></p>
            </div>
        </div>
        <h2 id="url-code-err" style="color: var(--red)" hidden></h2>
    </div>
    <script>
        /*
            We're planning to rewrite all codes of Shipwar. It may be deployed before year 2100 or never.
        */
       
        copyright(2023);

        const shipwarURL = `${window.location.origin}/game/ship-war/?code=`;
        const currentVersion = 103;
        cw("#version").text = `${String(currentVersion).slice(0, 1)}.${String(currentVersion).slice(1)}`;

        const onlineCode = urlParam.get("code");
        let first;
        let bigPlaced = 0;
        let atkCombo = [];
        
        let loaded = 0;
        
        let online = 0;
        let onlineWho = 0;
        let randOnlineFirst = false;
        let cache = "";
        let lastCode;
        let win = false;
        let biggestTarget = 0;

        let robot = false;
        const robotMemory = {
            placeSmall: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
            attack: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
            attackOriginal: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
        };
        let robotPlaceBigReady = false;
        let waitPlayerPlaceSmall;

        if (onlineCode) {
            cw("#code_type").el.value = onlineCode;
            cw("#rules").hide();
            cw("#url-code-err").unhide();
            onlineCodeEnter();
        }

        const posArray = {
            number: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
            string: ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36"],
            stringCache: ["00", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36"],
            position: ["00", "A1", "B1", "C1", "D1", "E1", "F1", "A2", "B2", "C2", "D2", "E2", "F2", "A3", "B3", "C3", "D3", "E3", "F3", "A4", "B4", "C4", "D4", "E4", "F4", "A5", "B5", "C5", "D5", "E5", "F5", "A6", "B6", "C6", "D6", "E6", "F6"]
        };

        function begin() {
            if (loaded) {
                loadGame();
            } else {
                fadeChange("rules", "choose_first");
            }
        }

        cw("#saveInput").el.addEventListener("change", () => { loaded = 1; });

        function randomFirst() {
            const seed = rand(1, 2);

            if (seed == 1) {
                firstPlayer(1);
            } else {
                firstPlayer(2);
            }
        }

        function firstPlayer(p) {
            fadeChange("choose_first", "main_panel");
            first = p;
            if (p == 1) {
                cw("#p1_status_1").html = `<strong>我方先手 ${online ? randOnlineFirst ? "(随机)" : "(指定)" : ""}</strong>`;
                cw("#p1_status_1").color = "var(--green)";
                cw("#p2_status_1").html = "<strong>敌方先手</strong>";
                cw("#p1_status_2").html = "<strong>请选择母舰位置</strong>";
                cw("#p1_status_2").color = "var(--green)";
                cw("#p2_status_2").html = "<strong>请选择母舰位置</strong>";
                cw("#p2_status_2").color = "var(--green)";
            } else {
                cw("#p1_status_1").html = `<strong>敌方先手 ${online ? randOnlineFirst ? "(随机)" : "(指定)" : ""}</strong>`;
                cw("#p2_status_1").color = "var(--green)";
                cw("#p2_status_1").html = "<strong>我方先手</strong>";
                cw("#p1_status_2").html = "<strong>请选择母舰位置</strong>";
                cw("#p1_status_2").color = "var(--green)";
                cw("#p2_status_2").html = "<strong>请选择母舰位置</strong>";
                cw("#p2_status_2").color = "var(--green)";
            }

            if (online) {
                cw("#p2_table_1").hide();
                cw("#p2_table_2").hide();
                cw("#p2_status_1").hide();
                cw("#p2_status_2").hide();
                cw("#p2_status_3").hide();
                cw("#subtitle").text = robot ? "单人游戏" : "联机模式";
                cw("#p1_status").style = "margin: auto auto auto auto !important;";
                cw("#p1_table_1").style = "margin: auto auto auto auto !important;";
                cw("#p1_table_2").style = "margin: auto auto auto auto !important;";
            } else {
                cw("#subtitle").text = "请准备好物理阻拦物, 确保玩家不会看到对方的操作界面";
                cw("#subtitle").color = "var(--red)";
            }
        }

        function p1PlaceBig(pos) {
            bigPlaced++;
            cw(`#display_p1_${posArray.number[pos]}`).el.innerHTML = "〓";
            for (let i = 1; i <= 36; i++) {
                cw(`#p1PlaceBigButton${i}`).disabled = true;
            }
            cw("#p1_status_3").html = `<strong>母舰已部署 (${posArray.position[pos]})</strong>`;
            cw("#p1_status_3").color = "var(--gray)";
            if (bigPlaced == 1) {
                cw("#p1_status_2").html = "<strong>请等待敌方选择母舰位置</strong>";
                cw("#p1_status_2").color = "#ff9900";
                if (online) {
                    cw("#online_finish").unhide();
                    onlineCodeBig();
                    if (robotPlaceBigReady) { waitPlayerPlaceSmall(); }
                }
            } else {
                cache += `3${posArray.stringCache[pos]}`;
                gameStart();
            }
        }

        function p2PlaceBig(pos) {
            bigPlaced++;
            cw(`#display_p2_${posArray.number[pos]}`).el.innerHTML = "〓";
            for (let i = 1; i <= 36; i++) {
                cw(`#p2PlaceBigButton${i}`).disabled = true;
            }
            cw("#p2_status_3").html = `<strong>母舰已部署 (${posArray.position[pos]})</strong>`;
            cw("#p2_status_3").color = "var(--gray)";
            if (bigPlaced == 1) {
                cw("#p2_status_2").html = "<strong>请等待敌方选择母舰位置</strong>";
                cw("#p2_status_2").color = "#ff9900";
                if (online) {
                    cw("#online_finish").unhide();
                    onlineCodeBig();
                }
            } else {
                cache += `3${posArray.stringCache[pos]}`;
                gameStart();
            }
        }

        function placeBigButtonHide(p) {
            for (let i = 1; i <= 36; i++) {
                cw(`#p${p}PlaceBigButton${i}`).hide();
            }
        }

        function gameStart() {
            cw("#goodTitle").html = "游戏进行中";
            cw("#goodTitle").color = "var(--green)";
            if (first == 1) {
                p1Round1();
            } else {
                p2Round1();
            }
            if (online == 0) {
                cw("#saveButton").style = "display: block; margin-left: 48%;";
            }
        }

        function p1Round1() {
            placeBigButtonHide(1);
            for (let i = 1; i <= 36; i++) {
                cw(`#p1PlaceSmallButton${i}`).hide();
                cw(`#p2PlaceSmallButton${i}`).hide();
                cw(`#p1AttackButton${i}`).hide();
                cw(`#p2AttackButton${i}`).disabled = true;
                cw(`#p1PlaceSmallButton${i}`).style = "margin-bottom: -3px; margin-left: -1px; display: inline;";
                cw(`#p1PlaceSmallButton${i}`).disabled = cw(`#display_p1_${i}`).el.innerHTML != "&nbsp;";
            }
            cw("#p1_status_1").html = "<strong>我方回合</strong>";
            cw("#p1_status_1").color = "var(--green)";
            cw("#p1_status_2").html = "<strong>请选择战列舰部署位置&nbsp;<button onclick=\"p1Round2()\" style=\"color: var(--green); margin-top: 0px; margin-bottom: 0px;\">跳过</button></strong>";
            cw("#p1_status_2").style = "color: var(--green); margin-bottom: 8px;";
            cw("#p2_status_1").html = "<strong>敌方回合</strong>";
            cw("#p2_status_1").color = "var(--textColor-500)";
            cw("#p2_status_2").html = "<strong>请等待敌方操作</strong>";
            cw("#p2_status_2").color = "var(--textColor-500)";
            if (online) {
                p2RoundOnlineFin();
                if (onlineWho == 2) {
                    cw("#p1_status_1").hide();
                    cw("#p1_status_2").hide();
                    cw("#p1_status_3").hide();
                }
            }
        }

        function p2Round1() {
            placeBigButtonHide(2);
            for (let i = 1; i <= 36; i++) {
                cw(`#p1PlaceSmallButton${i}`).hide();
                cw(`#p2PlaceSmallButton${i}`).hide();
                cw(`#p2AttackButton${i}`).hide();
                cw(`#p1AttackButton${i}`).disabled = true;
                cw(`#p2PlaceSmallButton${i}`).style = "margin-bottom: -3px; margin-left: -1px; display: inline;";
                cw(`#p2PlaceSmallButton${i}`).disabled = cw(`#display_p2_${i}`).el.innerHTML != "&nbsp;";
            }
            cw("#p2_status_1").html = "<strong>我方回合</strong>";
            cw("#p2_status_1").color = "var(--green)";
            cw("#p2_status_2").html = "<strong>请选择战列舰部署位置&nbsp;<button onclick=\"p2Round2()\" style=\"color: var(--green); margin-top: 0px; margin-bottom: 0px;\">跳过</button></strong>";
            cw("#p2_status_2").style = "color: var(--green); margin-bottom: 8px;";
            cw("#p1_status_1").html = "<strong>敌方回合</strong>";
            cw("#p1_status_1").color = "var(--textColor-500)";
            cw("#p1_status_2").html = "<strong>请等待敌方操作</strong>";
            cw("#p1_status_2").color = "var(--textColor-500)";
            if (online) {
                p1RoundOnlineFin();
                if (onlineWho == 1) {
                    cw("#p2_status_1").hide();
                    cw("#p2_status_2").hide();
                    cw("#p2_status_3").hide();
                }
            }
        }

        function p1PlaceSmall(pos) {
            cw(`#display_p1_${pos}`).html = "≡";
            cw("#p1_status_3").html = `<strong>战列舰已部署 (${posArray.position[pos]})</strong>`;
            cw("#p1_status_3").color = "var(--textColor-400)";
            cache += `1${posArray.stringCache[pos]}`;
            p1Round2();
        }

        function p2PlaceSmall(pos) {
            cw(`#display_p2_${pos}`).html = "≡";
            cw("#p2_status_3").html = `<strong>战列舰已部署 (${posArray.position[pos]})</strong>`;
            cw("#p2_status_3").color = "var(--textColor-400)";
            cache += `1${posArray.stringCache[pos]}`;
            p2Round2();
        }

        function p1Round2() {
            cw("#p1_status_1").html = "<strong>我方回合</strong>";
            cw("#p1_status_1").color = "var(--green)";
            cw("#p2_status_1").html = "<strong>敌方回合</strong>";
            cw("#p2_status_1").color = "var(--textColor-500)";

            cw("#p2_status_1").html = "<strong>敌方回合</strong>";
            cw("#p2_status_1").color = "var(--textColor-500)";
            cw("#p2_status_2").html = "<strong>请等待敌方操作</strong>";
            cw("#p2_status_2").color = "var(--textColor-500)";
            cw("#p1_status_2").html = "<strong>请选择攻击位置</strong>";
            cw("#p1_status_2").color = "var(--red)";

            for (let i = 1; i <= 36; i++) {
                cw(`#p2AttackButton${i}`).disabled = true;
                cw(`#p1PlaceSmallButton${i}`).hide();
                cw(`#p1AttackButton${i}`).style = "margin-bottom: -3px; margin-left: -1px; display: inline;";
                cw(`#p1AttackButton${i}`).disabled = false;
                cw(`#p1PlaceSmallButton${i}`).disabled = false;
            }
            
            if (online) {
                p2RoundOnlineFin();
                if (onlineWho == 2) {
                    cw("#p1_status_1").hide();
                    cw("#p1_status_2").hide();
                    cw("#p1_status_3").hide();
                }
            }
        }

        function p2Round2() {
            cw("#p2_status_1").html = "<strong>我方回合</strong>";
            cw("#p2_status_1").color = "var(--green)";
            cw("#p1_status_1").html = "<strong>敌方回合</strong>";
            cw("#p1_status_1").color = "var(--textColor-500)";

            cw("#p1_status_1").html = "<strong>敌方回合</strong>";
            cw("#p1_status_1").color = "var(--textColor-500)";
            cw("#p1_status_2").html = "<strong>请等待敌方操作</strong>";
            cw("#p1_status_2").color = "var(--textColor-500)";
            cw("#p2_status_2").html = "<strong>请选择攻击位置</strong>";
            cw("#p2_status_2").color = "var(--red)";

            for (let i = 1; i <= 36; i++) {
                cw(`#p1AttackButton${i}`).disabled = true;
                cw(`#p2PlaceSmallButton${i}`).hide();
                cw(`#p2AttackButton${i}`).style = "margin-bottom: -3px; margin-left: -1px; display: inline;";
                cw(`#p2AttackButton${i}`).disabled = false;
                cw(`#p2PlaceSmallButton${i}`).disabled = false;
            }

            if (online) {
                p1RoundOnlineFin();
                if (onlineWho == 1) {
                    cw("#p2_status_1").hide();
                    cw("#p2_status_2").hide();
                    cw("#p2_status_3").hide();
                }
            }
        }

        function p1Attack(pos) {
            atkCombo.push(posArray.position[pos]);
            cw("#display_p2_1").style = "";
            if (online) {
                cache += `2${posArray.stringCache[pos]}`;
            }
            if (cw(`#display_p2_${pos}`).html == "&nbsp;") {
                cw("#p1_status_3").html = `<strong>未发现敌方军舰 (${atkCombo.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--gray)";
                if (!online) {
                    cw("#p2_status_3").html = `<strong>敌方打空 (${atkCombo.join(", ")})</strong>`;
                    cw("#p2_status_3").color = "var(--gray)";
                } else { p1AttackOnlineP2Text(); }

                p2RoundCheck();
            }
            if (cw(`#display_p2_${pos}`).html == "≡") {
                if (biggestTarget < 1) { biggestTarget = 1; }

                cw("#p1_status_3").html = `<strong>已击毁敌方一艘战列舰! (${atkCombo.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--minor)";
                if (!online) {
                    cw("#p2_status_3").html = `<strong>我方一艘战列舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                    cw("#p2_status_3").color = "var(--minor)";
                } else { p1AttackOnlineP2Text(); }

                cw(`#display_p2_${pos}`).html = "&nbsp;";
                
                p1CheckVictory();
            }
            if (cw(`#display_p2_${pos}`).html == "〓") {
                if (biggestTarget < 2) { biggestTarget = 2; }

                cw("#p1_status_3").html = `<strong>已击毁敌方母舰! (${atkCombo.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--red)";
                if (!online) {
                    cw("#p2_status_3").html = `<strong>我方母舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                    cw("#p2_status_3").color = "var(--red)";
                } else { p1AttackOnlineP2Text(); }

                cw(`#display_p2_${pos}`).html = "&nbsp;";

                p1CheckVictory();
            }
        }

        function p1AttackOnlineP2Text() {
            if (biggestTarget == 0) {
                cw("#p2_status_3").html = `<strong>敌方打空 (${atkCombo.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--gray)";
            }
            if (biggestTarget == 1) {
                cw("#p2_status_3").html = `<strong>我方一艘战列舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--minor)";
            }
            if (biggestTarget == 2) {
                cw("#p2_status_3").html = `<strong>我方母舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--red)";
            }
        }

        function p1CheckVictory() {
            if (online) {
                if (onlineWho == 1) {
                    cw("#p2_status_3").hide();
                } else {
                    cw("#p1_status_3").hide();
                }
            }

            let emptyCounter = 0;
            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p2_${i}`).html == "&nbsp;") {
                    emptyCounter++;
                }
            }
            if (emptyCounter == 36) {
                win = true;
                if (onlineWho == 1) {
                    p1RoundOnlineFin();
                } else {
                    cw("#online_finish").hide();
                }
                cw("#goodTitle").html = "游戏结束";
                cw("#goodTitle").style = "color: var(--textColor-500);";
                cw("#subtitle").html = "&nbsp;";
                cw("#subtitle_showOne").html = "&nbsp;";
                cw("#saveButton").style = "display: none;";

                cw("#p1_status_1").html = "<strong>我方胜利!</strong>";
                cw("#p1_status_1").color = "var(--lightOrange)";
                cw("#p2_status_1").html = "<strong>我方战败</strong>";
                cw("#p2_status_1").color = "var(--red)";
                cw("#p1_status_2").html = "<strong>敌方所有军舰已被摧毁!</strong>";
                cw("#p1_status_2").color = "var(--lightOrange)";
                cw("#p2_status_2").html = "<strong>我方所有军舰已被摧毁!</strong>";
                cw("#p2_status_2").color = "var(--red)";

                applyAll("button", el => cw(el).disabled = true);

                if (online) {
                    if (onlineWho == 1) {
                        cw("#online_finish").unhide();
                        cw("#online_input").hide();
                    } else {
                        cw("#online_finish").hide();
                    }
                }
                throw new Error("Intended error to halt function execution");
            } else if (isBigSunk(1)) {
                p1Round2();
            } else {
                p2RoundCheck();
            }
        }

        function p2Attack(pos) {
            atkCombo.push(posArray.position[pos]);
            cw("#display_p1_1").style = "";
            if (onlineWho == 2) {
                cache += `2${posArray.stringCache[pos]}`;
            }
            if (cw(`#display_p1_${pos}`).html == "&nbsp;") {
                cw("#p2_status_3").html = `<strong>未发现敌方军舰 (${atkCombo.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--gray)";
                if (!online) {
                    cw("#p1_status_3").html = `<strong>敌方打空 (${atkCombo.join(", ")})</strong>`;
                    cw("#p1_status_3").color = "var(--gray)";
                } else { p2AttackOnlineP1Text(); }

                p1RoundCheck();
            }
            if (cw(`#display_p1_${pos}`).html == "≡") {
                if (biggestTarget < 1) { biggestTarget = 1; }
                
                cw("#p2_status_3").html = `<strong>已击毁敌方一艘战列舰! (${atkCombo.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--minor)";
                if (!online) {
                    cw("#p1_status_3").html = `<strong>我方一艘战列舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                    cw("#p1_status_3").color = "var(--minor)";
                } else { p2AttackOnlineP1Text(); }

                cw(`#display_p1_${pos}`).html = "&nbsp;";

                p2CheckVictory();
            }
            if (cw(`#display_p1_${pos}`).html == "〓") {
                if (biggestTarget < 2) { biggestTarget = 2; }

                cw("#p2_status_3").html = `<strong>已击毁敌方母舰! (${atkCombo.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--red)";
                if (!online) {
                    cw("#p1_status_3").html = `<strong>我方母舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                    cw("#p1_status_3").color = "var(--red)";
                } else { p2AttackOnlineP1Text(); }

                cw(`#display_p1_${pos}`).html = "&nbsp;";

                p2CheckVictory();
            }
        }

        function p2AttackOnlineP1Text() {
            if (biggestTarget == 0) {
                cw("#p1_status_3").html = `<strong>敌方打空 (${atkCombo.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--gray)";
            }
            if (biggestTarget == 1) {
                cw("#p1_status_3").html = `<strong>我方一艘战列舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--minor)";
            }
            if (biggestTarget == 2) {
                cw("#p1_status_3").html = `<strong>我方母舰已被击毁! (${atkCombo.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--red)";
            }
        }

        function p2CheckVictory() {
            if (online) {
                if (onlineWho == 1) {
                    cw("#p2_status_3").hide();
                } else {
                    cw("#p1_status_3").hide();
                }
            }

            let emptyCounter = 0;
            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p1_${i}`).html == "&nbsp;") {
                    emptyCounter++;
                }
            }
            if (emptyCounter == 36) {
                win = true;
                if (onlineWho == 1) {
                    cw("#online_finish").hide();
                } else {
                    p2RoundOnlineFin();
                }
                cw("#goodTitle").html = "游戏结束";
                cw("#goodTitle").style = "color: var(--textColor-500);";
                cw("#subtitle").html = "&nbsp;";
                cw("#subtitle_showOne").html = "&nbsp;";
                cw("#saveButton").hide();

                cw("#p2_status_1").html = "<strong>我方胜利!</strong>";
                cw("#p2_status_1").color = "var(--lightOrange)";
                cw("#p1_status_1").html = "<strong>我方战败</strong>";
                cw("#p1_status_1").color = "var(--red)";
                cw("#p2_status_2").html = "<strong>敌方所有军舰已被摧毁!</strong>";
                cw("#p2_status_2").color = "var(--lightOrange)";
                cw("#p1_status_2").html = "<strong>我方所有军舰已被摧毁!</strong>";
                cw("#p1_status_2").color = "var(--red)";

                applyAll("button", el => cw(el).disabled = true);

                if (online) {
                    if (onlineWho == 2) {
                        cw("#online_finish").unhide();
                        cw("#online_input").hide();
                    } else {
                        cw("#online_finish").hide();
                    }
                }
                throw new Error("Intended error to halt function execution");
            } else if (isBigSunk(2)) {
                p2Round2();
            } else {
                p1RoundCheck();
            }
        }

        function p1RoundCheck() {
            atkCombo = [];
            p1TextRecolor();
            if (isBigSunk(1)) {
                p1Round2();
            } else {
                p1Round1();
            }
        }

        function p2RoundCheck() {
            atkCombo = [];
            p2TextRecolor();
            if (isBigSunk(2)) {
                p2Round2();
            } else {
                p2Round1();
            }
        }

        function hideButtons(...buttonType) {
            const buttonTypeArray = [];

            if (buttonType.indexOf("PlaceBig") >= 0) { buttonTypeArray.push("PlaceBig"); }
            if (buttonType.indexOf("PlaceSmall") >= 0) { buttonTypeArray.push("PlaceSmall"); }
            if (buttonType.indexOf("Attack") >= 0) { buttonTypeArray.push("Attack"); }

            for (let i = 1; i <= 2; i++) {
                for (let j = 0; j < buttonTypeArray.length; j++) {
                    for (let k = 1; k <= 36; k++) {
                        cw(`#p${i}${buttonTypeArray[j]}Button${k}`).hide();
                    }
                }
            }
        }

        function saveGame() {
            let stage;
            if (cw("#p1_status_2").text.includes("请选择战列舰部署位置")) { stage = 0; }
            if (cw("#p1_status_2").text.includes("请选择攻击位置")) { stage = 1; }
            if (cw("#p2_status_2").text.includes("请选择战列舰部署位置")) { stage = 2; }
            if (cw("#p2_status_2").text.includes("请选择攻击位置")) { stage = 3; }

            const p1Data = {
                board: []
            };
            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p1_${i}`).html == "≡") {
                    p1Data.board.push(1);
                } else if (cw(`#display_p1_${i}`).html == "〓") {
                    p1Data.board.push(2);
                } else {
                    p1Data.board.push(0);
                }
            }

            const p2Data = {
                board: []
            };
            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p2_${i}`).html == "≡") {
                    p2Data.board.push(1);
                } else if (cw(`#display_p2_${i}`).html == "〓") {
                    p2Data.board.push(2);
                } else {
                    p2Data.board.push(0);
                }
            }

            const currentText1 = cw("#p1_status_3").html;
            if (currentText1.includes("战列舰已部署")) { p1Data.status = "deployed"; }
            if (currentText1.includes("未发现敌方军舰")) { p1Data.status = "undetected"; }
            if (currentText1.includes("敌方打空")) { p1Data.status = "missed"; }
            if (currentText1.includes("已击毁敌方一艘战列舰!")) { p1Data.status = "minor-destroyed"; }
            if (currentText1.includes("已击毁敌方母舰!")) { p1Data.status = "major-destroyed"; }
            if (currentText1.includes("我方一艘战列舰已被击毁!")) { p1Data.status = "minor-sank"; }
            if (currentText1.includes("我方母舰已被击毁!")) { p1Data.status = "major-sank"; }
            p1Data.pos = currentText1.match(/(?<=\().+(?=\))/)[0].split(", ");

            const currentText2 = cw("#p2_status_3").html;
            if (currentText2.includes("战列舰已部署")) { p2Data.status = "deployed"; }
            if (currentText2.includes("未发现敌方军舰")) { p2Data.status = "undetected"; }
            if (currentText2.includes("敌方打空")) { p2Data.status = "missed"; }
            if (currentText2.includes("已击毁敌方一艘战列舰!")) { p2Data.status = "minor-destroyed"; }
            if (currentText2.includes("已击毁敌方母舰!")) { p2Data.status = "major-destroyed"; }
            if (currentText2.includes("我方一艘战列舰已被击毁!")) { p2Data.status = "minor-sank"; }
            if (currentText2.includes("我方母舰已被击毁!")) { p2Data.status = "major-sank"; }
            p2Data.pos = currentText2.match(/(?<=\().+(?=\))/)[0].split(", ");

            const data = {
                signature: "chiwainori-shipWar",
                version: currentVersion,
                time: new Date().getTime(),
                data: {
                    stage,
                    p1: p1Data,
                    p2: p2Data
                }
            };

            save(`chiwainori-shipWar-${data.time}.json`, JSON.stringify(data));
        }

        async function loadGame() {
            let file;
            try {
                file = await loadJSON("saveInput");
            } catch (e) {
                cw("#text1").style = "font-size: 10px; color: var(--red);";
                if (e.cwErr == "f-loadJSON-invalid") {
                    cw("#text1").text = `无效的 JSON 文件`;
                    return;
                }
                cw("#text1").html = e.stack;
                return;
            }

            await sleep(50);

            cw("#text1").style = "font-size: 10px; color: var(--red);";
            if (file.signature != "chiwainori-shipWar") {
                cw("#text1").text = `错误的文件签名 (${file.signature})`;
                return;
            }
            if (file.version != currentVersion) {
                cw("#text1").text = `错误的文件版本 (${file.version}, 当前 ${currentVersion}). 请在本网页的地址后面加上 /../archive_${file.version}.html 以尝试在其他版本中加载.`;
                return;
            }
                
            if (file.data.stage == 0) { p1Round1(); }
            if (file.data.stage == 1) { p1Round2(); }
            if (file.data.stage == 2) { p2Round1(); }
            if (file.data.stage == 3) { p2Round2(); }
            hideButtons("PlaceBig");

            if (file.data.stage <= 1) {
                for (let i = 1; i <= 36; i++) {
                    cw(`#p2AttackButton${i}`).unhide("inline-block");
                    cw(`#p2AttackButton${i}`).disabled = true;
                }
            }
            if (file.data.stage >= 2) {
                for (let i = 1; i <= 36; i++) {
                    cw(`#p1AttackButton${i}`).unhide("inline-block");
                    cw(`#p1AttackButton${i}`).disabled = true;
                }
            }

            file.data.p1.board.forEach((block, index) => {
                if (block == 0) {
                    cw(`#display_p1_${index + 1}`).html = "&nbsp;";
                } else if (block == 1) {
                    cw(`#display_p1_${index + 1}`).html = "≡";
                } else if (block == 2) {
                    cw(`#display_p1_${index + 1}`).html = "〓";
                }
            });
            file.data.p2.board.forEach((block, index) => {
                if (block == 0) {
                    cw(`#display_p2_${index + 1}`).html = "&nbsp;";
                } else if (block == 1) {
                    cw(`#display_p2_${index + 1}`).html = "≡";
                } else if (block == 2) {
                    cw(`#display_p2_${index + 1}`).html = "〓";
                }
            });

            if (file.data.p1.status == "deployed") {
                cw("#p1_status_3").html = `<strong>战列舰已部署 (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--textColor-400)";
            }
            if (file.data.p1.status == "undetected") {
                cw("#p1_status_3").html = `<strong>未发现敌方军舰 (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--textColor-400)";
            }
            if (file.data.p1.status == "missed") {
                cw("#p1_status_3").html = `<strong>敌方打空 (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--textColor-400)";
            }
            if (file.data.p1.status == "minor-destroyed") {
                cw("#p1_status_3").html = `<strong>已击毁敌方一艘战列舰! (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--minor)";
            }
            if (file.data.p1.status == "major-destroyed") {
                cw("#p1_status_3").html = `<strong>已击毁敌方母舰! (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--red)";
            }
            if (file.data.p1.status == "minor-sank") {
                cw("#p1_status_3").html = `<strong>我方一艘战列舰已被击毁! (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--minor)";
            }
            if (file.data.p1.status == "major-sank") {
                cw("#p1_status_3").html = `<strong>我方母舰已被击毁! (${file.data.p1.pos.join(", ")})</strong>`;
                cw("#p1_status_3").color = "var(--red)";
            }

            if (file.data.p2.status == "deployed") {
                cw("#p2_status_3").html = `<strong>战列舰已部署 (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--textColor-400)";
            }
            if (file.data.p2.status == "undetected") {
                cw("#p2_status_3").html = `<strong>未发现敌方军舰 (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--textColor-400)";
            }
            if (file.data.p2.status == "missed") {
                cw("#p2_status_3").html = `<strong>敌方打空 (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--textColor-400)";
            }
            if (file.data.p2.status == "minor-destroyed") {
                cw("#p2_status_3").html = `<strong>已击毁敌方一艘战列舰! (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--minor)";
            }
            if (file.data.p2.status == "major-destroyed") {
                cw("#p2_status_3").html = `<strong>已击毁敌方母舰! (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--red)";
            }
            if (file.data.p2.status == "minor-sank") {
                cw("#p2_status_3").html = `<strong>我方一艘战列舰已被击毁! (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--minor)";
            }
            if (file.data.p2.status == "major-sank") {
                cw("#p2_status_3").html = `<strong>我方母舰已被击毁! (${file.data.p2.pos.join(", ")})</strong>`;
                cw("#p2_status_3").color = "var(--red)";
            }

            cw("#rules").hide();
            cw("#main_panel").unhide();
            cw("#goodTitle").html = "游戏进行中";
            cw("#goodTitle").color = "var(--green)";
            cw("#saveButton").style = "display: block; margin-left: 48%;";
        }

        function showOnlineText() {
            fadeChange("online_button", "online_text");
        }

        function onlineFirst(p) {
            online = 1;
            onlineWho = 1;
            cw("#saveButton").html = "联机模式不支持保存";
            cw("#saveButton").el.disabled = true;
            firstPlayer(p);
        }

        function onlineRandomFirst() {
            online = 1;
            onlineWho = 1;
            randOnlineFirst = true;
            cw("#saveButton").html = "联机模式不支持保存";
            cw("#saveButton").el.disabled = true;
            randomFirst();
        }

        function onlineCodeBig() {
            const key = BigInt(rand(1, 1295)); // 36 base 01 ~ ZZ
            let bigPos;

            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p1_${i}`).html == "〓") {
                    bigPos = i;
                }
            }

            if (cw("#p1_status_1").html.includes("我方先手")) {
                first = 1;
            } else {
                first = 2;
            }
            const firstCode = first + randOnlineFirst * 2; // 1: 我先手(选定) 2: 敌先手(选定) 3: 我先手(随机) 4: 敌先手(随机)
            const code = BigInt(`${firstCode}${bigPos}`) + key ^ key << 2n;

            cw("#online_code").html = `<span style="color: var(--gray);">${shipwarURL}</span><span style="font-size: 20px; letter-spacing: 4px; font-family: Consolas;">${key.toBase(36).padStart(2, "0")}${code.toBase(36)}</span><br />你的好友可以输入网址链接直接开始游戏，也可以在页面输入深色的代码来开始游戏`;
        }

        function onlineCodeEnter() {
            online = 1;
            onlineWho = 2;
            const code = cw("#code_type").el.value;

            if (!(/[^0-9A-Z]/).test(code)) {
                const key = BigInt(code.slice(0, 2).transBase(36, 10));
                let content = BigInt(code.slice(2).transBase(36, 10));
                content = String((content ^ key << 2n) - key);
                const firstCode = content.slice(0, 1);
                const bigPos = content.slice(1);

                if (firstCode < 1 || firstCode > 4 || bigPos < 0 || bigPos > 36 || bigPos[0] == "0") {
                    cw("#wrong_code").text = `错误的联机代码 at ${firstCode} ${bigPos}`;
                    cw("#url-code-err").text = `错误的联机代码 at ${firstCode} ${bigPos}`;
                    return;
                }

                cw(`#display_p1_${bigPos}`).html = "〓";
                fadeChange("choose_first", "main_panel");
                if (firstCode % 2 == 1) {
                    cw("#p2_status_1").html = `<strong>敌方先手 (${firstCode >= 2 ? "随机" : "指定"})</strong>`;
                    first = 1;
                } else {
                    cw("#p2_status_1").html = `<strong>我方先手 (${firstCode >= 3 ? "随机" : "指定"})</strong>`;
                    cw("#p2_status_1").color = "var(--green)";
                    first = 2;
                }
                cw("#p2_status_2").html = "<strong>请选择母舰位置</strong>";
                cw("#p2_status_2").color = "var(--green)";
                cw("#p1_table_1").hide();
                cw("#p1_table_2").hide();
                cw("#p1_status_1").hide();
                cw("#p1_status_2").hide();
                cw("#p1_status_3").hide();
                cw("#brs").hide();
                cw("#subtitle").hide();
                cw("#p2_status").style = "margin: auto auto auto auto !important;";
                cw("#p2_table_1").style = "margin: auto auto auto auto !important;";
                cw("#p2_table_2").style = "margin: auto auto auto auto !important;";
                bigPlaced = 1;
                cw("#online_code").style = "font-size: 24px; letter-spacing: 12px; font-family: Consolas;";
            } else {
                cw("#wrong_code").text = `错误的联机代码 at 0 0`;
                cw("#url-code-err").text = `错误的联机代码 at 0 0`;
            }
        }

        function p1RoundOnlineFin() {
            if (onlineWho == 1) {
                cw("#p2_status_1").hide();
                cw("#p2_status_2").hide();
                cw("#p2_status_3").hide();
                cw("#p1_status_1").html = "<strong>敌方回合</strong>";
                cw("#p1_status_1").color = "var(--textColor-500)";
                cw("#p1_status_2").html = "<strong>请等待敌方操作</strong>";
                cw("#p1_status_2").color = "var(--textColor-500)";
                cw("#p1_status_3").unhide();

                hideButtons("PlaceSmall");
                for (let i = 1; i <= 36; i++) {
                    cw(`#p1AttackButton${i}`).disabled = true;
                }
                if (online) {
                    cw("#online_finish").unhide();
                }
                p1TextRecolor();
                
                onlineEncode();
            }
            if (onlineWho == 2) {
                cw("#online_finish").hide(); // Prevent unexpected element unhide
            }
            if (robot) { robotAction(1); }
        }

        function onlineEncodeOLD() {
            const randomSeed = rand(10, 99); // 10 ~ 99
            const codeToShow = (parseInt(cache) + randomSeed) * randomSeed;
            log(cache, randomSeed, codeToShow); //                                        ['114221', 88, 10059192]
            cw("#online_code").html = `chiwainori-shipWar.olg.${randomSeed}${codeToShow}.`; // 变成别的数字
            cw("#code_from_friend").el.value = "";
            if (cw("#online_code").html.includes("NaN")) {
                cw("#online_finish").hide();
            }
            if (cw("#online_code").html.includes("e+")) { // 数字过大变成科学计数法了
                if (cache[0] == "2") {
                    cw("#online_code").html = `chiwainori-shipWar.olg.000${cache}.`;
                } else {
                    let firstStep = parseInt(cache.slice(0, 3)); // 第一步, 即 '102206207208209210211212213214' 中的 '102'
                    firstStep = (firstStep + randomSeed) * randomSeed;
                    const other = cache.slice(3); // 其他, 即 '102206207208209210211212213214' 中的 '206207208209210211212213214'

                    cw("#online_code").html = `chiwainori-shipWar.olg.${randomSeed}${firstStep}000${other}.`; // 000 前加密存储, 后明文存储
                }
            }
            cache = "";
        }

        function onlineEncode() {
            const key = BigInt(rand(1, 1295)); // 36 base 01 ~ ZZ
            code = (BigInt(cache) ^ key << 2n) + key;

            cw("#online_code").html = `${key.toBase(36).padStart(2, "0")}${code.toBase(36)}`;
            cw("#online_code").style = "font-size: 24px; letter-spacing: 12px; font-family: Consolas;";
            cw("#code_from_friend").value = "";
            cache = "";
        }

        function onlineDecode(code) {
            const key = BigInt(code.slice(0, 2).transBase(36, 10));
            const content = BigInt(code.slice(2).transBase(36, 10));

            return String(content - key ^ key << 2n);
        }

        function p2RoundOnlineFin() {
            if (onlineWho == 2) {
                cw("#p1_status_1").hide();
                cw("#p1_status_2").hide();
                cw("#p1_status_3").hide();
                cw("#p2_status_1").html = "<strong>敌方回合</strong>";
                cw("#p2_status_1").color = "var(--textColor-500)";
                cw("#p2_status_2").html = "<strong>请等待敌方操作</strong>";
                cw("#p2_status_2").color = "var(--textColor-500)";
                cw("#p2_status_3").unhide();

                hideButtons("PlaceSmall");
                for (let i = 1; i <= 36; i++) {
                    cw(`#p2AttackButton${i}`).disabled = true;
                }
                if (online) {
                    cw("#online_finish").unhide();
                }
                p2TextRecolor();
                
                onlineEncode();
            }
            if (onlineWho == 1) {
                cw("#online_finish").hide(); // Prevent unexpected element unhide
            }
        }

        function p1TextRecolor() {
            if (cw("#p1_status_3").html.includes("战列舰已部署")) {
                cw("#p1_status_3").color = "var(--gray)";
            }
            if (cw("#p1_status_3").html.includes("未发现敌方军舰")) {
                cw("#p1_status_3").color = "var(--gray)";
            }
            if (cw("#p1_status_3").html.includes("敌方打空")) {
                cw("#p1_status_3").color = "var(--gray)";
            }
            if (cw("#p1_status_3").html.includes("已击毁敌方一艘战列舰!")) {
                cw("#p1_status_3").color = "var(--minor)";
            }
            if (cw("#p1_status_3").html.includes("已击毁敌方母舰!")) {
                cw("#p1_status_3").color = "var(--red)";
            }
            if (cw("#p1_status_3").html.includes("我方一艘战列舰已被击毁!")) {
                cw("#p1_status_3").color = "var(--minor)";
            }
            if (cw("#p1_status_3").html.includes("我方母舰已被击毁!")) {
                cw("#p1_status_3").color = "var(--red)";
            }
        }

        function p2TextRecolor() {
            if (cw("#p2_status_3").html.includes("战列舰已部署")) {
                cw("#p2_status_3").color = "var(--gray)";
            }
            if (cw("#p2_status_3").html.includes("未发现敌方军舰")) {
                cw("#p2_status_3").color = "var(--gray)";
            }
            if (cw("#p2_status_3").html.includes("敌方打空")) {
                cw("#p2_status_3").color = "var(--gray)";
            }
            if (cw("#p2_status_3").html.includes("已击毁敌方一艘战列舰!")) {
                cw("#p2_status_3").color = "var(--minor)";
            }
            if (cw("#p2_status_3").html.includes("已击毁敌方母舰!")) {
                cw("#p2_status_3").color = "var(--red)";
            }
            if (cw("#p2_status_3").html.includes("我方一艘战列舰已被击毁!")) {
                cw("#p2_status_3").color = "var(--minor)";
            }
            if (cw("#p2_status_3").html.includes("我方母舰已被击毁!")) {
                cw("#p2_status_3").color = "var(--red)";
            }
        }

        function onlineContinue() {
            const errCode = checkAvailability(onlineDecode(cw("#code_from_friend").el.value));
            if (errCode) {
                cw("#online_warn").text = `错误的联机代码 of ${errCode}`;
                cw("#online_warn").color = "var(--red)";
                throw new SyntaxError(`Invalid online code of ${errCode}`);
            }

            cw("#online_b1").el.disabled = true;
            cw("#online_warn").color = "var(--orange)";
            cw("#confirm").unhide("inline-block");
            if (cw("#code_from_friend").el.value == cw("#online_code").el.innerText || cw("#code_from_friend").el.value == cw("#online_code").html.match(/chiwainori-shipWar.olg.[0-9]+./g)) {
                cw("#online_warn").text = "[!] 警告: 此代码与你刚刚生成的代码相同. 如确认无误, 请再次按下确认按钮.";
                return;
            }
            if (cw("#code_from_friend").el.value == lastCode) {
                cw("#online_warn").text = "[!] 警告: 此代码与你上次输入的代码相同. 如确认无误, 请再次按下确认按钮.";
                return;
            }

            cw("#online_warn").html = "&nbsp;";
            cw("#online_b1").el.disabled = false;
            cw("#confirm").hide();
            lastCode = cw("#code_from_friend").el.value;
            biggestTarget = 0;
            cw("#goodTitle").html = "游戏进行中";
            cw("#goodTitle").color = "var(--green)";
            cw("#saveButton").hide();
            cw("#online_finish").hide();

            if (onlineWho == 1) {
                p1OnlineContinue(onlineDecode(cw("#code_from_friend").el.value));
            } else {
                p2OnlineContinue(onlineDecode(cw("#code_from_friend").el.value));
            }
        }
        function onlineContinueForce() {
            cw("#online_warn").html = "&nbsp;";
            cw("#online_b1").el.disabled = false;
            cw("#confirm").hide();
            lastCode = cw("#code_from_friend").el.value;
            biggestTarget = 0;
            if (onlineWho == 1) {
                p1OnlineContinue(onlineDecode(cw("#code_from_friend").el.value));
            } else {
                p2OnlineContinue(onlineDecode(cw("#code_from_friend").el.value));
            }
        }

        function p1OnlineContinue(codeToBeProceed) {
            while (codeToBeProceed >= 100) {
                codeToBeProceed = codeToBeProceed.toString(); // '334'

                const nowPos = codeToBeProceed[1] + codeToBeProceed[2]; // '34'
                if (codeToBeProceed[0] == "1") { // PlaceSmall
                    cw(`#display_p2_${parseInt(nowPos)}`).html = "≡";
                }
                if (codeToBeProceed[0] == "2") { // Attack
                    p2Attack(parseInt(nowPos));
                }
                if (codeToBeProceed[0] == "3") { // PlaceBig
                    cw(`#display_p2_${parseInt(nowPos)}`).html = "〓";
                }

                if (codeToBeProceed.length > 3) {
                    codeToBeProceed = codeToBeProceed.slice(3);
                } else {
                    codeToBeProceed = "0";
                }
                codeToBeProceed = parseInt(codeToBeProceed);
            }
            
            if (!win) { p1RoundCheck(); }
        }

        function p2OnlineContinue(codeToBeProceed) {
            while (codeToBeProceed >= 100) {
                codeToBeProceed = codeToBeProceed.toString(); // '334'
                const nowPos = codeToBeProceed[1] + codeToBeProceed[2]; // '34'
                if (codeToBeProceed[0] == "1") { // PlaceSmall
                    cw(`#display_p1_${parseInt(nowPos)}`).html = "≡";
                }
                if (codeToBeProceed[0] == "2") { // Attack
                    p1Attack(parseInt(nowPos));
                }
                if (codeToBeProceed[0] == "3") { // PlaceBig
                    cw(`#display_p1_${parseInt(nowPos)}`).html = "〓";
                }
                if (codeToBeProceed.length > 3) {
                    codeToBeProceed = codeToBeProceed.slice(3);
                } else {
                    codeToBeProceed = "0";
                }
                codeToBeProceed = parseInt(codeToBeProceed);
            }

            if (!win) { p2RoundCheck(); }
        }
    
        cw("#code_from_friend").event("input", function () {
            cw("#online_b1").disabled = this.value == "";
        });

        function checkAvailability(code) {
            if (code.length % 3 != 0) { return "length-invalid"; }
            if (code[0] == "-") { return "neg"; }

            const actArr = [];

            for (let i = 0; i < code.length; i += 3) {
                actArr.push(code.slice(i, i + 3));
            }

            for (let i = 0; i < actArr.length; i++) {
                if (actArr[i][0] != "1" && actArr[i][0] != "2" && actArr[i][0] != "3") {
                    return `act-invalid at ${i} for ${actArr[i][0]}`;
                }
                const pos = Number(actArr[i].slice(1));
                if (pos > 36 || pos < 1) {
                    return `pos-invalid at ${i} for ${pos}`;
                }
            }

            return false;
        }

        function isBigSunk(player) {
            let notBigCounter = 0;

            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p${player}_${i}`).html != "〓") {
                    notBigCounter++;
                }
            }

            return notBigCounter == 36;
        }

        function startRobot(whoFirst) {
            robot = true;
            if (whoFirst) { onlineFirst(whoFirst); } else { onlineRandomFirst(); }
            cw("#online-area").hide();
            cw("#single-await").unhide();

            robotAction(0);
        }

        async function robotAction(type) {
            if (win) {
                cw("#single-await").hide();
                return;
            }
            
            if (type == 0) { // PlaceBig
                cw("#single-await").text = "你的操作已经结束。请等待对手操作 .";
                await sleep(rand(150, 300));
                cw("#single-await").text = "你的操作已经结束。请等待对手操作 ..";
                await sleep(rand(150, 300));
                cw("#single-await").text = "你的操作已经结束。请等待对手操作 ...";
                await sleep(rand(150, 300));
                cw("#single-await").text = "你的操作已经结束。请等待对手操作 ....";
                await sleep(rand(150, 300));
                cw("#single-await").text = "你的操作已经结束。请等待对手操作 .....";
                await sleep(rand(150, 300));
                
                const code = `3${String(rand(1, 36)).padStart(2, "0")}`;
                robotPlaceBigReady = true;

                if (isBigSunk(1)) {
                    const playerPlaceSmall = new Promise(resolve => waitPlayerPlaceSmall = resolve);
                    await playerPlaceSmall;
                }

                p1OnlineContinue(code);

                cw("#goodTitle").html = "游戏进行中";
                cw("#goodTitle").color = "var(--green)";

                if (first == 2) {
                    cw("#p1_status_1").html = "<strong>敌方回合</strong>";
                    cw("#p1_status_1").color = "var(--textColor-500)";
                    cw("#p1_status_2").html = "<strong>请等待敌方操作</strong>";
                    cw("#p1_status_2").color = "var(--textColor-500)";
                    cw("#online_finish").unhide();
                    robotAction(1);
                }
                
                return;
            }

            if (!cw("#p1_status_3").text.includes("母舰已部署") && !cw("#p1_status_3").text.includes("未发现") && !cw("#p1_status_3").text.includes("已击毁")) {
                return; // Prevent unexpected function call
            }
            
            let code = "";

            if (!isBigSunk(2) && chance(botWillToPlaceSmall(countOfShip(2)))) {
                const placeSmallPos = robotMemory.placeSmall[rand(0, robotMemory.placeSmall.length - 1)];
                robotMemory.placeSmall = robotMemory.placeSmall.remove(placeSmallPos);
                code += `1${String(placeSmallPos).padStart(2, "0")}`;
            }

            let missed = false;
            let timer = 0;

            while (!missed) {
                const attackPos = robotMemory.attack[rand(0, robotMemory.attack.length - 1)];
                robotMemory.attack = robotMemory.attack.remove(attackPos);
                code += `2${String(attackPos).padStart(2, "0")}`;

                if (cw(`#display_p1_${attackPos}`).text.includes("〓")) { // Big sank, reset attack table
                    robotMemory.attack = robotMemory.attackOriginal.isolate().remove(attackPos);
                }

                if (!isBigSunk(2) || !cw(`#display_p1_${attackPos}`).text.includes("〓") && !cw(`#display_p1_${attackPos}`).text.includes("≡")) {
                    missed = true;
                }

                timer += rand(1500, 2500);
            }

            timer /= 5;
            cw("#single-await").text = "你的操作已经结束。请等待对手操作 .";
            await sleep(rand(timer - 100, timer + 100));
            cw("#single-await").text = "你的操作已经结束。请等待对手操作 ..";
            await sleep(rand(timer - 100, timer + 100));
            cw("#single-await").text = "你的操作已经结束。请等待对手操作 ...";
            await sleep(rand(timer - 100, timer + 100));
            cw("#single-await").text = "你的操作已经结束。请等待对手操作 ....";
            await sleep(rand(timer - 100, timer + 100));
            cw("#single-await").text = "你的操作已经结束。请等待对手操作 .....";
            await sleep(rand(timer - 100, timer + 100));

            biggestTarget = 0;
            p1OnlineContinue(code);
        }

        function countOfShip(p) {
            let counter = 0;
            for (let i = 1; i <= 36; i++) {
                if (cw(`#display_p${p}_${i}`).text.includes("≡") || cw(`#display_p${p}_${i}`).text.includes("〓")) {
                    counter++;
                }
            }
            return counter;
        }

        function botWillToPlaceSmall(smallOnBoard) {
            return smallOnBoard.percentage(rand(7, 9), rand(12, 14)).transit(1, 0);
        }
    </script>
</div></body>

</html>