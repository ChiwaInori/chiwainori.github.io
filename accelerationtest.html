<script src="/xts-functions.js"></script>

<head></head>

<body></body>

<!-- EXPERIMENTAL CODES -->
<h1>实时加速度显示 (≧∇≦)/</h1>
<div class="acceleration" id="acceleration-x">X: 0</div>
<div class="acceleration" id="acceleration-y">Y: 0</div>
<div class="acceleration" id="acceleration-z">Z: 0</div>
<button id="request-permission">请求加速度权限</button>

<script>
    function handleMotionEvent(event) {
        let acc = event.acceleration;
        if (acc) {
            document.getElementById('acceleration-x').textContent = 'X: ' + acc.x.toFixed(2);
            document.getElementById('acceleration-y').textContent = 'Y: ' + acc.y.toFixed(2);
            document.getElementById('acceleration-z').textContent = 'Z: ' + acc.z.toFixed(2);
        }
    }

    document.getElementById('request-permission').addEventListener('click', function () {
        if (typeof DeviceMotionEvent.requestPermission === 'function') {
            DeviceMotionEvent.requestPermission()
                .then(function (permissionState) {
                    if (permissionState === 'granted') {
                        window.addEventListener('devicemotion', handleMotionEvent);
                        document.getElementById('request-permission').style.display = 'none';
                    } else {
                        alert('加速度权限被拒绝了哦~ (>_<)');
                    }
                })
                .catch(console.error);
        } else {
            alert('您的设备不支持权限请求哦~ (>_<)');
        }
    });
</script>