<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <title>加速度测速 - xtsdcb69</title>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/globalformat.css">
    <script src="/xts-functions.js"></script>
</head>

<body>
    <div class="title">
        <h1>加速度测速</h1>
    </div>
    <div class="navigation">
        <h6><a href="../">XTSGAMES.TOP</a> &gt; <strong></strong></h6>
    </div>
    <div class="content">
        <p>1111111</p>
        <button id="first" onclick="run()">初始化</button>
        <br />
        <p id="accelerationData"></p>
        <p id="accelerationData2"></p>
        <p id="velocityX" style="display: none;">0</p>
        <p id="velocityY" style="display: none;">0</p>
        <p id="velocityZ" style="display: none;">0</p>
        <p id="gravityX" style="display: none;">0</p>
        <p id="gravityY" style="display: none;">0</p>
        <p id="gravityZ" style="display: none;">0</p>
        <p id="accelerationX" style="display: none;">0</p>
        <p id="accelerationY" style="display: none;">0</p>
        <p id="accelerationZ" style="display: none;">0</p>
    </div>
    <script>
        navigator.permissions.query({ name: "accelerometer" }).then((result) => {
        if (result.state === "granted") {
            const acl = new Accelerometer({ frequency: 60 });
            acl.addEventListener("reading", () => {
                const vector = [acl.x, acl.y, acl.z];
                document.getElementById("accelerationX").innerHTML = acl.x;
                document.getElementById("accelerationY").innerHTML = acl.y;
                document.getElementById("accelerationZ").innerHTML = acl.z;

                var accXnoG = acl.x - parseFloat(document.getElementById("gravityX").innerHTML);
                var accYnoG = acl.y - parseFloat(document.getElementById("gravityY").innerHTML);
                var accZnoG = acl.z - parseFloat(document.getElementById("gravityZ").innerHTML);

                var velocityXnew = parseFloat(document.getElementById("velocityX").innerHTML) + accXnoG;
                var velocityYnew = parseFloat(document.getElementById("velocityY").innerHTML) + accYnoG;
                var velocityZnew = parseFloat(document.getElementById("velocityZ").innerHTML) + accZnoG;

                var velocity = Math.sqrt(velocityXnew ** 2 + velocityYnew ** 2 + velocityZnew ** 2);
                document.getElementById("velocityX").innerHTML = velocityXnew;
                document.getElementById("velocityY").innerHTML = velocityYnew;
                document.getElementById("velocityZ").innerHTML = velocityZnew;

                var velocityKmPerH = velocity * 3.6;
                document.getElementById("accelerationData2").innerHTML = velocity + "m/s || " + velocityKmPerH + "km/h";
            });
            acl.start();
        }

        function update() {
            document.getElementById("accelerationData").innerHTML = document.getElementById("accelerationData2").innerHTML;
        }
        setInterval("update()", "200");
        
        function run() {
            document.getElementById("velocityX").innerHTML = "0";
            document.getElementById("velocityY").innerHTML = "0";
            document.getElementById("velocityZ").innerHTML = "0";
            document.getElementById("gravityX").innerHTML = document.getElementById("accelerationX").innerHTML;
            document.getElementById("gravityY").innerHTML = document.getElementById("accelerationY").innerHTML;
            document.getElementById("gravityZ").innerHTML = document.getElementById("accelerationZ").innerHTML;
        }
  });
    </script>
    <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js">
        $('#permission').on('click', function() {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                        // handle data
                        window.addEventListener('devicemotion', function(event) {
                            var accelerationData = event.acceleration;
                            var dataString = 'X: ' + accelerationData.x + ', Y: ' + accelerationData.y + ', Z: ' + accelerationData.z;
                            document.getElementById('accelerationData').innerHTML = dataString;
                        });
                        } else {
                        // handle denied
                        }
                    })
                    .catch((err) => {
                        console.log(err);
                    });
            }
        });
    </script> -->
</body>

</html>